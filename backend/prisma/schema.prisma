generator client {
  provider = "prisma-client"
  output   = "../src/generated"
}

datasource db {
  provider = "postgresql"
}

model Booking {
  id         Int      @id @default(autoincrement())
  userId     Int
  resourceId Int
  date       DateTime @db.Date
  startTime  DateTime @db.Timestamp(6)
  endTime    DateTime @db.Timestamp(6)
  createdAt  DateTime @default(now()) @db.Timestamp(6)
  updatedAt  DateTime @default(now()) @db.Timestamp(6)
  Resource   Resource @relation(fields: [resourceId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_resource")
  User       User     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_user")

  @@unique([resourceId, date, startTime, endTime], map: "unique_booking")
  @@index([resourceId], map: "idx_booking_resource")
  @@index([userId], map: "idx_booking_user")
}

model Resource {
  id        Int       @id @default(autoincrement())
  name      String    @db.VarChar(255)
  active    Boolean   @default(true)
  createdAt DateTime  @default(now()) @db.Timestamp(6)
  updatedAt DateTime  @default(now()) @db.Timestamp(6)
  Booking   Booking[]
}

model User {
  id        Int       @id @default(autoincrement())
  email     String    @unique @db.VarChar(255)
  password  String
  role      Role      @default(USER)
  createdAt DateTime  @default(now()) @db.Timestamp(6)
  updatedAt DateTime  @default(now()) @db.Timestamp(6)
  Booking   Booking[]
}

enum Role {
  USER
  ADMIN
}
